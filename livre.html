<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rapport d'Ã‰tude des VÅ“ux â€“ Livre d'Or PRO Augustin Muteb</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

<style>
/* VARIABLES CSS (ThÃ¨me GÃ©ologie PRO) - CohÃ©rent avec la palette professionnelle */
:root {
Â  Â  --primaire: #004D99; /* Bleu Cobalt Profond (plus sÃ©rieux) */
Â  Â  --primaire-fonce: #003366;
Â  Â  --secondaire: #FFC300; /* Or vif pour l'accent */
Â  Â  --fond-clair: #F8F9FA; /* Blanc cassÃ© (Papier Ã  dessin technique) */
Â  Â  --fond-sombre: #fff;
Â  Â  --texte: #343A40; /* Gris Anthracite (Gravier fin) */
Â  Â  --ombre-pro: 0 15px 45px rgba(0, 0, 0, 0.15);Â 
Â  Â  --rayon-faible: 8px;Â 
Â  Â  --transition-rapide: 0.35s ease-in-out;
}

/* BARRE DE PROGRESSION DE LECTURE */
#progressBar {
Â  Â  position: fixed; top: 0; left: 0; width: 0%; height: 5px;Â 
Â  Â  background-color: var(--secondaire);Â 
Â  Â  z-index: 1000;
Â  Â  transition: width 0.1s linear;
Â  Â  box-shadow: 0 0 10px rgba(255, 195, 0, 0.5);
}

/* RESET et FOND */
body {
Â  Â  font-family: 'Montserrat', sans-serif;
Â  Â  margin: 0; padding: 0;
Â  Â  background-color: var(--fond-clair);
Â  Â  color: var(--texte);
Â  Â  text-align: center; line-height: 1.6;
Â  Â  padding-bottom: 50px;
}

/* STRUCTURE PRINCIPALE */
.container {
Â  Â  max-width: 1300px;Â 
Â  Â  margin: 0 auto;
Â  Â  padding: 0 20px;
}

/* HEADER/TITRES PersonnalisÃ©s */
header {
Â  Â  background-color: var(--fond-sombre);
Â  Â  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
Â  Â  margin-bottom: 50px;
Â  Â  padding: 40px 0 20px 0;
Â  Â  border-bottom: 5px solid var(--primaire);Â 
}

h1 {
Â  Â  color: var(--primaire);
Â  Â  font-family: 'Playfair Display', serif;
Â  Â  font-size: 3.8em;
Â  Â  margin: 0;
Â  Â  letter-spacing: 2px;
Â  Â  position: relative;
Â  Â  display: inline-block;
}
h1 i {
Â  Â  color: var(--secondaire);
Â  Â  margin-right: 10px;
}
p.subtitle {
Â  Â  font-size: 1.4em;
Â  Â  color: #5A6268;
Â  Â  margin-top: 15px;
Â  Â  font-weight: 500;
}

/* EFFET DE PARALLAXE SUR LA PHOTO */
.hero {
Â  Â  max-height: 350px;
Â  Â  margin-top: 0;Â 
Â  Â  margin-bottom: 40px;
Â  Â  border-radius: 0;
Â  Â  box-shadow: none;
Â  Â  border-bottom: 2px solid #EEE;
Â  Â  overflow: hidden;
Â  Â  position: relative;
}
.hero img {
Â  Â  width: 100%;
Â  Â  height: 350px;
Â  Â  object-fit: cover;
Â  Â  filter: grayscale(0%) brightness(100%);
Â  Â  transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
Â  Â  transform: translateY(var(--y, 0)) scale(1.05);
}

/* GRILLE DES TÃ‰MOIGNAGES */
#temoignages-container {
Â  Â  display: grid;
Â  Â  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
Â  Â  gap: 30px;
Â  Â  margin-top: 40px;
}

/* AMÃ‰LIORATION DE LA CARTE (Rendu bloc-note / page de rapport) */
.card {
Â  Â  background-color: var(--fond-sombre);
Â  Â  padding: 35px;
Â  Â  border-radius: var(--rayon-faible);
Â  Â  box-shadow: var(--ombre-pro);
Â  Â  text-align: left;
Â  Â  transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.4, 1), box-shadow 0.4s ease;
Â  Â  border: 1px solid #E0E0E0;Â 
Â  Â  border-left: 7px solid var(--primaire); /* Ligne d'annotation Bleue */
}
.card:hover {
Â  Â  transform: translateY(-5px);
Â  Â  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.12);
Â  Â  border-left-color: var(--secondaire);
}

.card-message {
Â  Â  font-style: normal;Â 
Â  Â  font-size: 1.05em;
Â  Â  margin-bottom: 25px;
Â  Â  color: var(--texte);
Â  Â  border-bottom: 1px dashed #CCC;Â 
Â  Â  padding-bottom: 15px;
Â  Â  white-space: pre-wrap;
}
.card-message i.fa-quote-left {
Â  Â  color: var(--primaire);Â 
Â  Â  margin-right: 8px;
Â  Â  font-size: 1.2em;
}

.card-author-name {
Â  Â  font-weight: 700;
Â  Â  color: var(--primaire-fonce);
Â  Â  letter-spacing: 0.5px;
}
.card-author-name i {
Â  Â  color: var(--secondaire);
Â  Â  margin-right: 5px;
}

/* Ã‰TATS PARTICULIERS (CHARGEMENT, AUCUN MESSAGE) */
#loading, #no-messages {
Â  Â  background-color: var(--fond-sombre);
Â  Â  margin: 50px auto;
Â  Â  padding: 40px;
Â  Â  border-radius: var(--rayon-faible);
Â  Â  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
Â  Â  border-left: 5px solid var(--secondaire);
}

/* BOUTON RETOUR et BOUTON IMPRIMER (Style plus technique) */
.action-buttons {
Â  Â  margin-top: 60px;
Â  Â  display: flex;
Â  Â  justify-content: center;
Â  Â  gap: 30px;
}
.action-buttons a, .action-buttons button {
Â  Â  color: var(--fond-sombre);
Â  Â  background-image: linear-gradient(135deg, var(--primaire), var(--primaire-fonce));Â 
Â  Â  padding: 15px 30px;
Â  Â  border-radius: 50px;Â 
Â  Â  font-weight: 700;
Â  Â  text-decoration: none;
Â  Â  border: none;
Â  Â  cursor: pointer;
Â  Â  font-size: 1em;
Â  Â  box-shadow: 0 8px 15px rgba(0, 77, 153, 0.3);
Â  Â  transition: all 0.3s;
}
.action-buttons a:hover, .action-buttons button:hover {
Â  Â  transform: translateY(-3px);
Â  Â  box-shadow: 0 10px 20px rgba(0, 77, 153, 0.5);
}

/* OPTIMISATION POUR IMPRESSION */
@media print {
Â  Â  body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
Â  Â  .hero, header, .action-buttons, footer, #progressBar { display: none !important; }
Â  Â  .card {
Â  Â  Â  Â  border: 1px solid #AAA !important;Â 
Â  Â  Â  Â  box-shadow: none !important;
Â  Â  Â  Â  border-radius: 0 !important;
Â  Â  Â  Â  margin: 10px 0 !important;
Â  Â  Â  Â  padding: 15px !important;
Â  Â  Â  Â  border-left: 10px solid #000 !important;Â 
Â  Â  }
}

/* MEDIA QUERIES */
@media(max-width: 768px) {
Â  Â  h1 { font-size: 2.8em; }
}
</style>
</head>
<body>

<div id="progressBar"></div>

<div class="hero">
Â  Â  <img id="hero-img" src="photo8.jpeg" alt="Portrait Professionnel d'Augustin Muteb, GÃ©ologue" loading="lazy"/>
</div>

<header>
Â  Â  <div class="container">
Â  Â  Â  Â  <h1><i class="fas fa-chart-line"></i> Rapport d'Ã‰tude des VÅ“ux</h1>
Â  Â  Â  Â  <p class="subtitle">Messages et vÅ“ux sincÃ¨res pour Augustin Muteb, GÃ©ologue.</p>
Â  Â  </div>
</header>

<div class="container">
Â  Â Â 
Â  Â  <div id="loading">
Â  Â  Â  Â  <i class="fas fa-circle-notch fa-spin"></i> **Traitement des donnÃ©es gÃ©ologiques...**
Â  Â  </div>

Â  Â  <div id="temoignages-container">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  <div id="no-messages" style="display: none;">
Â  Â  Â  Â  <i class="fas fa-box-open"></i> Le gisement est inexplorÃ©. Soyez le premier Ã  contribuer au rapport !
Â  Â  </div>

Â  Â  <div class="action-buttons">
Â  Â  Â  Â  <button id="printButton" onclick="window.print()">
Â  Â  Â  Â  Â  Â  <i class="fas fa-print"></i> GÃ©nÃ©rer le **Rapport d'Impression**
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <a href="index.html">
Â  Â  Â  Â  Â  Â  <i class="fas fa-pen-nib"></i> RÃ©diger un nouveau tÃ©moignage
Â  Â  Â  Â  </a>
Â  Â  </div>

</div>

<footer>
Â  Â  â€” Rapport Final Augustin Muteb | Un IngÃ©nieur GÃ©ologue CompÃ©tent â€”
</footer>

<script>
// ==========================================================
// ðŸš¨ CONFIGURATION FIREBASE (MISE Ã€ JOUR)
// ==========================================================
const firebaseConfig={
Â  apiKey:"AIzaSyAiMnvIMBqn2VqSQsFpb-Ajx5VORVd0JoA",
Â  authDomain: "danicakakudji.firebaseapp.com",
Â  projectId: "danicakakudji",
Â  storageBucket: "danicakakudji.firebasestorage.app",
Â  messagingSenderId: "409346091245",
Â  appId: "1:409346091245:web:6674becbc81d97c292c4e4"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

// RÃ©fÃ©rences DOM
const container = document.getElementById('temoignages-container');
const loading = document.getElementById('loading');
const noMessages = document.getElementById('no-messages');

/**
Â * Logique pour l'effet de ParallaxeÂ 
Â */
const heroImg = document.getElementById('hero-img');
if (heroImg) {
Â  Â  window.addEventListener('scroll', () => {
Â  Â  Â  Â  const scrollPosition = window.scrollY;
Â  Â  Â  Â  const yOffset = Math.min(scrollPosition * 0.2, 30);
Â  Â  Â  Â  heroImg.style.setProperty('--y', `${yOffset}px`);
Â  Â  });
}

/**
Â * Logique pour la Barre de Progression de LectureÂ 
Â */
window.addEventListener('scroll', () => {
Â  Â  const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
Â  Â  const scrollPosition = window.scrollY;
Â  Â  const progress = (scrollPosition / totalHeight) * 100;
Â  Â  document.getElementById('progressBar').style.width = `${progress}%`;
});


/* FONCTIONS FIREBASE ET AFFICHAGE */
function formatDate(timestamp) {
Â  Â  if (!timestamp || !timestamp.toDate) return 'Date inconnue';
Â  Â  const date = timestamp.toDate();
Â  Â  return date.toLocaleDateString('fr-FR', {
Â  Â  Â  Â  year: 'numeric',
Â  Â  Â  Â  month: 'long',
Â  Â  Â  Â  day: '2-digit',
Â  Â  Â  Â  hour: '2-digit',
Â  Â  Â  Â  minute: '2-digit',
Â  Â  Â  Â  second: '2-digit'
Â  Â  });
}

function createCardHTML(data) {
Â  Â  const formattedDate = formatDate(data.timestamp);
Â  Â  // SÃ©curitÃ© : Assurer que le nom et le message sont sÃ»rs
Â  Â  const safeName = data.name ? data.name.replace(/</g, "&lt;").replace(/>/g, "&gt;") : 'Anonyme';
Â  Â  const safeMessage = data.message ? data.message.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\n/g, '<br>') : 'Message vide.';

Â  Â  return `
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <p class="card-message">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-quote-left"></i> ${safeMessage}
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  <div class="card-author">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-author-name">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-user-tie"></i> ${safeName}
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-timestamp">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-calendar-alt"></i> ${formattedDate}
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  `;
}

async function loadTestimonials() {
Â  Â  loading.style.display = 'block';
Â  Â  container.innerHTML = '';
Â  Â  noMessages.style.display = 'none';

Â  Â  // DÃ©finir le destinataire attendu pour le filtre (Augustin Muteb)
Â  Â  const DESTINATAIRE = "Augustin Muteb";Â 

Â  Â  try {
Â  Â  Â  Â  // REQUÃŠTE FILTRÃ‰E ET TRIÃ‰E (NÃ©cessite l'index composite)
Â  Â  Â  Â  const snapshot = await db.collection("testimonials")
Â  Â  Â  Â  Â  Â  .where("recipient", "==", DESTINATAIRE) 
Â  Â  Â  Â  Â  Â  .orderBy("timestamp", "desc")
Â  Â  Â  Â  Â  Â  .get();

Â  Â  Â  Â  loading.style.display = 'none';

Â  Â  Â  Â  if (snapshot.empty) {
Â  Â  Â  Â  Â  Â  noMessages.style.display = 'block';
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  let cardsHTML = '';
Â  Â  Â  Â  snapshot.docs.forEach(doc => {
Â  Â  Â  Â  Â  Â  const data = doc.data();
Â  Â  Â  Â  Â  Â  cardsHTML += createCardHTML(data);
Â  Â  Â  Â  });

Â  Â  Â  Â  container.innerHTML = cardsHTML;
Â  Â  Â  Â Â 
Â  Â  } catch (error) {
Â  Â  Â  Â  // Affiche un message d'erreur professionnel si la connexion ou l'index Ã©choue
Â  Â  Â  Â  console.error("Erreur lors du chargement des tÃ©moignages:", error);
Â  Â  Â  Â  loading.innerHTML = `<i class="fas fa-exclamation-triangle"></i> **Erreur critique de lecture des donnÃ©es.** <br>Si l'erreur persiste, vÃ©rifiez que l'**Index Composite Firestore** suivant a Ã©tÃ© crÃ©Ã© : <strong>\`testimonials\`</strong> avec les champs <strong>\`recipient (Asc)\`</strong> et <strong>\`timestamp (Desc)\`</strong>.`;
Â  Â  Â  Â  loading.style.display = 'block';
Â  Â  }
}

document.addEventListener('DOMContentLoaded', loadTestimonials);
</script>
</body>
</html>
